BootStrap: library
From: ubuntu:20.04

%files
    /mnt/mnemo5/tao/conda_envs/sequence_tools_environment.yml  /home/conda_envs
    /mnt/mnemo5/tao/conda_envs/py37_pydca_environment.yml      /home/conda_envs

%post
    apt-get update && apt-get -y upgrade
    apt-get -y install \
    build-essential \
    wget \
    less 
    
    # seem this is singularity comment grammer
    # problem here the # seem not the total the comment grammar, other section for example in %files

    
    # Installing miniconda, https://stackoverflow.com/questions/54678805/containerize-a-conda-environment-in-a-singularity-container,https://docs.conda.io/projects/miniconda/en/latest/index.html,
    wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh #-O ~/miniconda3/miniconda.sh, here need to careful with fodler inside container, this comand install to root "/" folder 
    bash  Miniconda3-latest-Linux-x86_64.sh -b -u -p /home/miniconda3 # this install to /home
    
    
    /home/miniconda3/bin/conda init bash # initialize your newly-installed Miniconda, but not working , why 
    
    
    
    # #install conda enviroment
    # /home/miniconda3/bin/conda create  -n sequence_tools -f sequence_tools_environment.yml
    # /home/miniconda3/bin/conda create  -n py37_pydca     -f py37_pydca_environment.yml
    
    #List installed environments
    /home/miniconda3/bin/conda info --envs
    
    
    

%environment
    export LC_ALL=C
    export PATH="/home/miniconda3/bin/conda:$PATH" # check this:   /root/.bashrc
    
    



%runscript
    echo "this section defines actions for the container to take when it is executed. (These commands will therefore not be run at build time.)"

# cd /mnt/mnemo5/tao/PPI_Prediction_byCoevolution/containers
# singularity build --remote --sandbox /mnt/mnemo5/tao/singularity_containers/PPICoe /mnt/mnemo5/tao/PPI_Prediction_byCoevolution/containers/PPICoe.def
# or  singularity build --fakeroot /mnt/mnemo5/tao/singularity_containers/PPICoe.sif /mnt/mnemo5/tao/PPI_Prediction_byCoevolution/containers/PPICoe.def


# enter the container : singularity shell PPICoe.sif

#     /bin/bash ~/miniconda3/miniconda.sh -b -u -p ~/miniconda3
#     rm -rf ~/miniconda3/miniconda.sh



