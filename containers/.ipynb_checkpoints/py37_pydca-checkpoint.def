BootStrap: library
From: ubuntu:20.04



%post
    apt-get update && apt-get -y upgrade
    apt-get -y install \
    build-essential \
    wget \
    less 
  
    wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh 
    bash  Miniconda3-latest-Linux-x86_64.sh -b -u -p /home/miniconda3 
    
    . /home/miniconda3/etc/profile.d/conda.sh
    

    # this is necessary for nextlfow, so the need envs is activated without extra operation
    echo ". /home/miniconda3/etc/profile.d/conda.sh" >> $SINGULARITY_ENVIRONMENT
    echo "conda activate py37_pydca" >> $SINGULARITY_ENVIRONMENT
    
    

    conda create -n py37_pydca python==3.7
                         
    conda activate py37_pydca
    
    pip install pydca

    # conda remove numpy
    pip uninstall -y numpy 

    pip uninstall -y numba
    conda install -c numba numba=0.46.0


    conda info --envs


    
    

%environment
    export LC_ALL=C
    export PATH=$PATH:/home/miniconda3/bin/conda # check this:   /root/.bashrc, this is nomal linux exprot grammer "export PATH="/home/miniconda3/bin/conda:$PATH""
    
    

%runscript
    echo "this section defines actions for the container to take when it is executed. (These commands will therefore not be run at build time.)"


# cd ~/PPI_Prediction_byCoevolution/containers
# or  singularity build --fakeroot ~/singularity_containers/py37_pydca.sif ~/PPI_Prediction_byCoevolution/containers/py37_pydca.def




