
// https://carpentries-incubator.github.io/workflows-nextflow/08-configuration/index.html


//set intermediate results folder 
//Generally, variables and functions defined in a configuration file are not accessible from the workflow script. Only variables defined using the params scope and the env scope (without env prefix) can be accessed from the workflow script.

params{
        // workDir="/mnt/mnemo6/tao/nextflow/work" 
        // RawData_Folder = "/mnt/mnemo6/tao/nextflow/STRING_Data_11.5"
        // PPI_Coevolution = "/mnt/mnemo6/tao/nextflow/PPI_Coevolution"
        root_folder="/mnt/mnemo6/tao"
        conda_envs_path="/mnt/mnemo5/tao/anaconda3/envs" // can set this to empty later, since most system use name to refer envs directly
        container_path="" // by default diretetyl pull from the library website,  "/mnt/mnemo5/tao/singularity_containers", ''
        // if pull from weibsite: WARN: Singularity cache directory has not been defined -- Remote image will be stored in the path: /mnt/mnemo6/tao/nextflow/work/singularity -- Use the environment variable NXF_SINGULARITY_CACHEDIR to specify a different location
    
        query_currentSpe_TaxID = "511145"
        query_current_EggNOG_maxLevel = "1224"
        subject1_currentSpe_TaxID = "1274374"
        subject1_current_EggNOG_maxLevel = "1239"
        subject2_currentSpe_TaxID = "105422"
        subject2_current_EggNOG_maxLevel = "201174"
        subject3_currentSpe_TaxID = "411476"
        subject3_current_EggNOG_maxLevel = "976"
        Nf90_thres = "16"
    
        small_cpu_nums = 8
        middle_cpu_nums = 30
        large_cpu_nums = 100
    
        small_memory = 32.GB
        middle_memory = 128.GB
        large_memory = 300.GB
    
        small_mp_task_nums = "10"
        middle_mp_task_nums = "30"
        large_mp_task_nums = "50"
    
        params.DCA_blockSize = 30// "30"
        param.singleDCA_memory= 32.GB
    
        code_utilities_folder = "${projectDir}/../src/utilities/"
        phmmer_path = "phmmer"
        clustalo_path = "clustalo"
        hmmbuild_path = "hmmbuild" 
        hmmalign_path = "hmmalign"
        blastp_path = "blastp"
    

        
}


profiles {
    
    standard { 
        // this one passed test ,local executor
        workDir="${params.root_folder}/nextflow/work" 
        conda.enabled = true  //this line is necesseary,  https://www.nextflow.io/docs/latest/conda.html

        includeConfig 'conf/standard.config'    
    }
    
    

    singularity {
        // this one passed test , singularity with local executor
        
        singularity.enabled    = true
        singularity.autoMounts = true        
        singularity.runOptions = "--bind ${params.root_folder}" // this give permission to singularity to mount ths folder https://github.com/nextflow-io/nextflow/discussions/2567,https://www.nextflow.io/docs/latest/singularity.html
        
        conda.enabled = false
        
        workDir="${params.root_folder}/nextflow/work"   //this line is necesseary,  https://www.nextflow.io/docs/latest/conda.html
        
        includeConfig 'conf/standard.config'    
    }
    
    
    slurm    { 
        
        conda.enabled = true //this line is necesseary,  https://www.nextflow.io/docs/latest/conda.html
        singularity.enabled    = false
        
        workDir="${params.root_folder}/nextflow/work" // for s3it. its "/shares/von-mering.imls.uzh/tao"
        
        

        //can we put this here ?, if so later can also just load standard profile 
        process {
            executor = 'slurm'
            time=48.h
        }
        
        executor {
            // queueSize = 100
            queueSize = 10
            submitRateLimit = '5 sec'
        }
        
        includeConfig 'conf/standard.config' 
        // includeConfig 'conf/slurm.config'    
        //https://github.com/nf-core/radseq/blob/bff60aca8031af5d59284ab337962437bc1b543c/nextflow.config
    } 

    
    
    slurm_withSingularity    { 
         
        singularity.enabled    = true
        singularity.autoMounts = true        
        singularity.runOptions = "--bind ${params.root_folder}" // by default /shares at s3it is mouted already, but no hurm 
        
        conda.enabled = false //this line is necesseary,  https://www.nextflow.io/docs/latest/conda.html
        
        workDir="${params.root_folder}/nextflow/work" // for s3it. its "/shares/von-mering.imls.uzh/tao"
        
        

        //can we put this here ?, if so later can also just load standard profile 
        process {
            executor = 'slurm'
            time=48.h
        }
        
        executor {
            // queueSize = 100
            queueSize = 10
            submitRateLimit = '5 sec'
        }
        
        includeConfig 'conf/standard.config'    
    } 
    
    
    
    
}






